DMA, или Direct Memory Access – технология прямого доступа к памяти, минуя центральный процессор. В эпоху 486-ых и первых Pentium во всю царствовала шина ISA, а также метод обмена данными между устройствами – PIO (Programmed Input/Output).

PIO по своей сути прост: чтобы получить данные с устройства, драйвер операционной системы (или же firmware другого устройства), должен был читать эти данные из регистров устройства. Давайте разберемся на примере:

- На сетевую карту пришло 1500 байт данных.
- Сетевая карта инициирует прерывание с целью сообщить процессору, что данные необходимо забрать с устройства, иначе произойдет так называемый buffer overrun.
- Операционная система ловит прерывание от контроллера прерываний и отдает его на обработку драйверу.
- Драйвер в цикле побайтно читает данные с регистров сетевой карты.

В итоге, если чтение одного байта отнимает около 1 мс процессорного времени, то чтение 1500 байт – соответственно 1500 мс. Но это всего лишь один Ethernet пакет, представте себе, сколько пакетов получает сетевая карта, когда вы читаете любимый хабрахабр. Конечно в реальности чтение в PIO режиме можно организовывать по 2, 4 байта, однако потери производительности при этом все равно будут катастрофическими.

_То есть, когда мы хотим подать «плюс» или «минус» на какую-то ножку МК, мы просто записываем единицу или ноль в определённый регистр в области Peripheral, и происходит соединение/разъединение этой ножки с электрической шиной. То же самое происходит с таймером — когда мы хотим его запустить, то записываем единичку в нужный регистр, таймер соединяется с тактирующей шиной и начинает тикать. Если хотим узнать сколько он натикал, то лезем в соответствующий регистр и смотрим что там лежит._
![[Pasted image 20240711162658.png]]