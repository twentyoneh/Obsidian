## Глава 1 (отрицание)
После попыток пропинговать устройство на HAL v.1.11.2 (безуспешно), понял что stm не хочет отправлять arp запросы, т.е. пк даже не знает о её существовании -> просидев 2 дня над этим я понял что нужно найти альтернативу и мне попалась статья про udp + FreeRTOS + lwip 
Суть в следующем - я завожу отдельный поток под нужды Ethernet  там есть бесконечный цикл -> просто отправляю udp сообщения каждую секунду
После первоначальной настройки и запуска выяснилось следующее: STM научилась отвечать на ARP запросы (аллилуйя) но так как это до сих пор просто отсылка UDP пакетов - я не могу на stm-ке понять отослался ли проект или нет.
Следующий шаг был - с помощью wireshark беру и сканирую мой Ethernet -> arp запросы вижу, udp как не было так и нет
![[Pasted image 20240814123836.png]]
как видно - какие-то udp пакеты передаются, но там лежит какая-то рандомная информация, и после 4-5 секунд картина с пакетами превращается в следующее:
![[Pasted image 20240814123948.png]]
udp пакетов как не было так и нет)

после этого я подумал - надо бы проверить правильность настройки всех тех структур которые я создаю
```
struct udp_pcb* my_udp = udp_new();
   if (my_udp == NULL) {
      printf("Failed to create UDP PCB\n");
      return;
  }
if (udp_connect(my_udp, &PC_IPADDR, 33333) != ERR_OK) {
      printf("UDP connection failed with error: %d\n", udp_connect(my_udp, &PC_IPADDR, 33333));
      return;
  }
```
Cледующий шаг я бы проверил что вообще лежит внутри буфера 

После иницилизации my_udp = udp_new();
udp_connect(my_udp, &PC_IPADDR, 33333)
![[Pasted image 20240814130128.png]]
Видим следующие поля: 
![[Pasted image 20240814130448.png]]
remote_ip: 192.168.1.5
flags : 4 (в душе не чаю что это за флаг)
local_port: 55325 
remote_port: 33 333

После этого смотрим что внутри нашего буфера
![[Pasted image 20240814131048.png]]
![[Pasted image 20240814131830.png]]
Внутри указателя на следующую структуру лежит указатель на следующую структуру(прежде чем понять рекурсию, надо сначала понять рекурсию)
![[Pasted image 20240814131843.png]]
короче че тут лежит внутри буфера если будет желание разберусь, мне важно лишь то что он чем-то заполняется и освобождается после отправки. Ну и то что нет никаких ошибок в момент отправки)
![[Pasted image 20240814132512.png]]
если кратко - всё работает... (но только внутри stm)
![[Pasted image 20240814132451.png]]
Попытка пингануть -> да, ничего для ответа на пинг у нас у платы нет, но с чем чёрт не шутит, нам важно что компуктер знает о существовании stm
![[Pasted image 20240814132900.png]]

Двигаемся дальше 

## Глава 2 (гнев)

отчаявшись я снёс проект и заново создал его 