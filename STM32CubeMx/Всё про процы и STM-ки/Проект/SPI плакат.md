SPI. SPI позволяет реализовать полудуплексный или полнодуплексный, синхронный обмен последовательными данными с внешними устройствами. Этот интерфейс можно сконфигурировать либо как в режиме главного устройства (master), либо как в режиме подчиненного устройства (slave). В режиме главного устройства SPI формирует выходной сигнал тактов (SCK) для внешнего подчиненного устройства. Интерфейс позволяет также работать в конфигурации с несколькими главными устройствами на шине (конфигурация multimaster).

**Структура SPI**

- **Мастер (Master)**: Устройство, инициирующее передачу данных.
- **Слэйв (Slave)**: Устройство, получающее команды от мастера.

**Пин-Конфигурация**

- **MOSI (Master Out Slave In)**: Пин передачи данных от мастера к слэйву.
- **MISO (Master In Slave Out)**: Пин передачи данных от слэйва к мастеру.
- **SCK (Serial Clock)**: Тактовый сигнал, генерируемый мастером.
- **SS/CS (Slave Select/Chip Select)**: Выбор слэйва, управляющий его включением.
![[Pasted image 20240723175131.png]]
Есть четыре возможных режима SPI, которые определяются комбинацией CPOL и CPHA:

Режим 0 (CPOL = 0, CPHA = 0):
    
    Полярность: тактовый сигнал низкий (0) в состоянии покоя.
    Фаза: данные захватываются по переднему фронту (с низкого на высокий).
Режим 1 (CPOL = 0, CPHA = 1):
    
    Полярность: тактовый сигнал низкий (0) в состоянии покоя.
    Фаза: данные захватываются по заднему фронту (с высокого на низкий).
Режим 2 (CPOL = 1, CPHA = 0):
    
    Полярность: тактовый сигнал высокий (1) в состоянии покоя.
    Фаза: данные захватываются по переднему фронту (с высокого на низкий).
Режим 3 (CPOL = 1, CPHA = 1):
    
    Полярность: тактовый сигнал высокий (1) в состоянии покоя.
    Фаза: данные захватываются по заднему фронту (с низкого на высокий).

Все особенности описаны в datasheet соответвующего устройства

![[Pasted image 20240730114954.png]]
![[Pasted image 20240730115036.png]]
Пример настройки в 
![[Pasted image 20240730145905.png]]

Преимущества
Полнодуплексная передача данных по умолчанию.
Более высокая пропускная способность по сравнению с I²C или SMBus.
Возможность произвольного выбора длины пакета, длина пакета не ограничена восемью битами.
Простота аппаратной реализации.
Используется только четыре вывода, что гораздо меньше, чем для параллельных интерфейсов.
Однонаправленный характер сигналов позволяет при необходимости легко организовать гальваническую развязку между ведущим и ведомыми устройствами.
Максимальная тактовая частота ограничена только быстродействием устройств, участвующих в обмене данными.
Недостатки
Необходимо больше выводов, чем для интерфейса I²C.
Ведомое устройство не может управлять потоком данных.
Нет подтверждения приёма данных со стороны ведомого устройства (ведущее устройство может передавать данные «в никуда»).
Нет определённого стандартом протокола обнаружения ошибок.
Отсутствие официального стандарта, что делает невозможным сертификацию устройств.
По дальности передачи данных интерфейс SPI уступает таким стандартам, как UART и CAN.
Наличие множества вариантов реализации интерфейса.
Нет поддержки горячего подключения устройств.