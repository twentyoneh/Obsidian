## Ethernet
https://www.linecall.de/wp-content/uploads/2016/11/802.3-2015_SECTION1.pdf (стр 113 Frame Check Sequence (FCS) field)
Циклическая проверка избыточности (CRC) используется алгоритмами передачи и приема для генерации значения CRC для поля FCS. Поле FCS содержит 4-октетное (32-разрядное) значение CRC. Это значение вычисляется как функция содержимого защищенных полей MAC-фрейма: **адреса назначения**, **Адреса источника**, **поля длины/типа**, данных MAC-клиента и Pad (то есть всех полей, кроме FCS).
## IP
Для вычисления контрольной суммы IP-заголовка используются все поля заголовка IP, начиная с первого байта поля `Version` и заканчивая последним байтом поля `Options`, если оно присутствует. Основные поля заголовка IPv4, которые включаются в расчет контрольной суммы, следующие:

1. **Version** (4 бита): Версия IP (обычно 4 для IPv4).
2. **IHL (Internet Header Length)** (4 бита): Длина IP-заголовка.
3. **Type of Service** (8 бит): Поле типа обслуживания.
4. **Total Length** (16 бит): Полная длина IP-пакета (заголовок + данные).
5. **Identification** (16 бит): Идентификатор пакета.
6. **Flags** (3 бита): Флаги управления фрагментацией.
7. **Fragment Offset** (13 бит): Смещение фрагмента.
8. **Time to Live (TTL)** (8 бит): Время жизни пакета.
9. **Protocol** (8 бит): Протокол уровня выше (TCP, UDP и т.д.).
10. **Header Checksum** (16 бит): Контрольная сумма заголовка (это поле при расчете временно устанавливается в ноль).
11. **Source Address** (32 бита): IP-адрес отправителя.
12. **Destination Address** (32 бита): IP-адрес получателя.
13. **Options** (если присутствует, переменной длины): Дополнительные параметры.

## UDP
Контрольная сумма UDP охватывает следующие поля:

2. **Заголовок UDP**:
    
    - **Source Port** (16 бит): Порт источника.
    - **Destination Port** (16 бит): Порт назначения.
    - **Length** (16 бит): Длина UDP-пакета (заголовок + данные).
    - **Checksum** (16 бит): Контрольная сумма (при расчете этого поля временно устанавливается в ноль).
3. **Данные (полезная нагрузка)**:
    
    - Полезная нагрузка (данные) UDP-пакета (может быть нулевой длины, но при этом длина должна быть кратна 16 битам).



![[Pasted image 20240902174852.png]]
