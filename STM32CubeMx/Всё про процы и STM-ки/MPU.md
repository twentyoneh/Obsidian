Cortex Memory Protection Unit (MPU) — это аппаратный компонент, встроенный в микропроцессоры семейства ARM Cortex. Он используется для защиты памяти и обеспечения безопасности программного обеспечения. MPU выполняет важные функции, которые позволяют предотвращать несанкционированный доступ к определенным областям памяти, что особенно важно в системах, где безопасность и надежность имеют критическое значение.
### Основные функции MPU:

1. **Разделение памяти на регионы**: MPU позволяет разделять доступную память на несколько регионов, каждый из которых может иметь свои настройки прав доступа. Это позволяет изолировать различные части приложения друг от друга, например, операционную систему от прикладного ПО или различные модули внутри приложения.
    
2. **Управление правами доступа**: Для каждого региона можно настроить права доступа, такие как разрешение на чтение, запись и выполнение. Это позволяет предотвращать доступ неавторизованных частей программы к критическим данным или коду.
    
3. **Защита от некорректного поведения программ**: MPU помогает предотвращать ошибки, которые могут возникнуть из-за неправильного использования памяти, такие как буферные переполнения или доступ к неинициализированным данным. Это особенно важно в встраиваемых системах, где ошибки могут привести к сбоям в работе устройства.
    
4. **Повышение безопасности системы**: За счет разделения памяти и ограничения прав доступа MPU уменьшает вероятность эксплуатации уязвимостей и атак на систему, таких как переполнение буфера или атаки типа "исполнение произвольного кода".
![[Pasted image 20240819095153.png]]

#mem_map 
![[Pasted image 20240820122111.png]]
![[Pasted image 20240821110119.png]]
### **MPU SubRegion Disable**

MPU позволяет разделить каждый регион памяти на подрегионы, каждый из которых можно индивидуально включать или отключать с помощью механизма SubRegion Disable. Это полезно для более точного управления доступом к памяти.
### **MPU TEX field level**

TEX (Type Extension) — это поле в настройках MPU, которое расширяет возможности настройки типа памяти. Оно используется совместно с другими полями для определения свойств региона памяти, таких как кэширование, буферизация и тип доступа.
### **MPU Access Permission**

MPU Access Permission задает права доступа для каждого региона памяти.

- **Возможные права доступа**:
    - **No Access (NA)**: доступ запрещен.
    - **Read-Only (RO)**: разрешен только доступ на чтение.
    - **Read-Write (RW)**: разрешен как доступ на чтение, так и на запись.
- **Контекст доступа**: Права доступа могут различаться для привилегированных (супервизорных) режимов работы процессора и непривилегированных (пользовательских) режимов.
### **MPU Instruction Access**

MPU Instruction Access отвечает за управление доступом к выполнению инструкций из определенного региона памяти.

- **Исполняемость**: Если разрешение на выполнение инструкций установлено, процессор может выполнять код, хранящийся в данном регионе памяти. Если нет, то попытка выполнения инструкций приведет к ошибке доступа. Это полезно для защиты памяти, чтобы предотвратить выполнение неподписанного или вредоносного кода.
### **MPU Shareability Permission**

Shareability Permission определяет, может ли данная область памяти быть доступной для нескольких процессоров или ядер (в многопроцессорных системах).

- **Типы Shareability**:
    - **Non-shareable**: Память доступна только для одного процессора или ядра.
    - **Shareable**: Память может быть доступна для нескольких процессоров или ядер, что важно для кэширования и синхронизации данных в многопроцессорных системах.
### **MPU Cacheable Permission**

Cacheable Permission указывает, можно ли кэшировать содержимое региона памяти.

- **Значение**: Если память помечена как кэшируемая, данные, считанные из этого региона, могут быть сохранены в кэше процессора, что ускоряет доступ к этим данным. Это полезно для часто используемых данных, где важна скорость доступа.
### **MPU Bufferable Permission**

Bufferable Permission указывает, можно ли использовать буферизацию для операций записи в память.

- **Буферизация**: Если разрешение на буферизацию включено, процессор может использовать write buffer для временного хранения данных перед записью в память. Это улучшает производительность за счет сокращения времени, затрачиваемого на ожидание завершения записи данных в память.